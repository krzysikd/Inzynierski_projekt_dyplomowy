godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
srednie_dzienne_zuzycie <- roczne_zuzycie / dni_w_roku
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Funkcja generujaca godzinowe zuzycie energii dla każdego dnia
generuj_godzinowe_zuzycie <- function(dzienne_zuzycie) {
godzinowy_rozklad <- runif(24, min = 0, max = 1)
godzinowe_zuzycie <- dzienne_zuzycie * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Wypelniamy ramke danych godzinowym zuzyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
pora <- pora_roku(data)
# Tutaj możesz dodać różne wartości dziennego zużycia w zależności od pory roku
if(pora == "zima") {
dzienne_zuzycie <- runif(1, min = 6, max = 10)
} else if(pora == "lato") {
dzienne_zuzycie <- runif(1, min = 3, max = 6)
} else {
dzienne_zuzycie <- runif(1, min = 4, max = 8)
}
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
View(godzinowe_dane_zuzycia)
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data, dzienne_zuzycie) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie godzinowego rozkładu dla danej pory roku
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczanie godzinowego zużycia energii uwzględniając porę roku i godzinowy rozkład
godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
srednie_dzienne_zuzycie <- roczne_zuzycie / dni_w_roku
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Wypełniamy ramkę danych godzinowym zużyciem energii opartym na porze roku
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
# Używamy średniego dziennego zużycia zamiast losowej wartości
dzienne_zuzycie <- srednie_dzienne_zuzycie
# Wykorzystujemy wcześniejszą funkcję generującą godzinowe zużycie na podstawie pory roku
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartości godzinowego zużycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
View(godzinowe_dane_zuzycia)
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data, dzienne_zuzycie) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie godzinowego rozkładu dla danej pory roku
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczanie godzinowego zużycia energii uwzględniając porę roku i godzinowy rozkład
godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
srednie_dzienne_zuzycie <- roczne_zuzycie / dni_w_roku
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Funkcja generujaca godzinowe zuzycie energii dla każdego dnia
generuj_godzinowe_zuzycie <- function(dzienne_zuzycie) {
godzinowy_rozklad <- runif(24, min = 0, max = 1)
godzinowe_zuzycie <- dzienne_zuzycie * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Wypelniamy ramke danych godzinowym zuzyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
dzienne_zuzycie <- runif(1, min = 4, max = 8)
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartosci godzinowego zuzycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
# Sortujemy ramke danych wedlug daty i godziny
godzinowe_dane_zuzycia <- godzinowe_dane_zuzycia[order(godzinowe_dane_zuzycia$Data, godzinowe_dane_zuzycia$Godzina), ]
# Resetujemy indeks wierszy
rownames(godzinowe_dane_zuzycia) <- seq_len(nrow(godzinowe_dane_zuzycia))
# Grupujemy dane wedlug dnia i obliczamy dziennie zuzycie energii
dzienna_dane <- godzinowe_dane_zuzycia %>%
group_by(Data) %>%
summarise(DzienneZuzycie = sum(Zuzycie))
# Dodajemy kolumnę z rokiem
godzinowe_dane_zuzycia$Rok <- year(godzinowe_dane_zuzycia$Data)
# Grupujemy dane według roku i miesiąca, a następnie obliczamy miesięczne zużycie energii
miesieczne_dane <- godzinowe_dane_zuzycia %>%
mutate(Miesiac = month(Data)) %>%
group_by(Rok, Miesiac) %>%
summarise(MiesieczneZuzycie = sum(Zuzycie))
# Grupujemy dane wedlug roku i obliczamy roczne zuzycie energii
roczne_zuzycie <- godzinowe_dane_zuzycia %>%
mutate(Rok = year(Data)) %>%
group_by(Rok) %>%
summarise(RoczneZuzycie = sum(Zuzycie))
# Sprawdzamy wyniki
head(godzinowe_dane_zuzycia)
head(dzienna_dane)
head(miesieczne_dane)
head(roczne_zuzycie)
godzinowe_dane_zuzycia$Godzina <- as.character(godzinowe_dane_zuzycia$Godzina)
str(godzinowe_dane_zuzycia)
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data, dzienne_zuzycie) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie godzinowego rozkładu dla danej pory roku
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczanie godzinowego zużycia energii uwzględniając porę roku i godzinowy rozkład
godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
srednie_dzienne_zuzycie <- roczne_zuzycie / dni_w_roku
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Wypelniamy ramke danych godzinowym zuzyciem energii na podstawie funkcji generującej godzinowe zużycie opartej na porze roku
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, srednie_dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartosci godzinowego zuzycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
View(godzinowe_dane_zuzycia)
# Grupujemy dane według roku i miesiąca, a następnie obliczamy miesięczne zużycie energii
miesieczne_dane <- godzinowe_dane_zuzycia %>%
mutate(Miesiac = month(Data)) %>%
group_by(Rok, Miesiac) %>%
summarise(MiesieczneZuzycie = sum(Zuzycie))
# Sortujemy ramke danych wedlug daty i godziny
godzinowe_dane_zuzycia <- godzinowe_dane_zuzycia[order(godzinowe_dane_zuzycia$Data, godzinowe_dane_zuzycia$Godzina), ]
# Resetujemy indeks wierszy
rownames(godzinowe_dane_zuzycia) <- seq_len(nrow(godzinowe_dane_zuzycia))
# Grupujemy dane wedlug dnia i obliczamy dziennie zuzycie energii
dzienna_dane <- godzinowe_dane_zuzycia %>%
group_by(Data) %>%
summarise(DzienneZuzycie = sum(Zuzycie))
#https://www.pse.pl/home
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data, dzienne_zuzycie) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie godzinowego rozkładu dla danej pory roku
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczanie godzinowego zużycia energii uwzględniając porę roku i godzinowy rozkład
godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
srednie_dzienne_zuzycie <- roczne_zuzycie / dni_w_roku
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Wypelniamy ramke danych godzinowym zuzyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
dzienne_zuzycie <- srednie_dzienne_zuzycie  # używamy stałej wartości zamiast losowej
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartosci godzinowego zuzycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
#https://www.pse.pl/home
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data, dzienne_zuzycie) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie godzinowego rozkładu dla danej pory roku
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczanie godzinowego zużycia energii uwzględniając porę roku i godzinowy rozkład
godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Wypełniamy ramkę danych godzinowym zużyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczenie dziennego zużycia energii dla danej pory roku
dzienne_zuzycie <- roczne_zuzycie / dni_w_roku * wspolczynnik_pory_roku
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartości godzinowego zużycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
View(godzinowe_dane_zuzycia)
library(dplyr)
library(tidyr)
library(lubridate)
library(ggplot2)
library(highcharter)
library(ggthemes)
library(scales)
library(RColorBrewer)
#https://www.pse.pl/home
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data, dzienne_zuzycie) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie godzinowego rozkładu dla danej pory roku
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczanie godzinowego zużycia energii uwzględniając porę roku i godzinowy rozkład
godzinowe_zuzycie <- dzienne_zuzycie * wspolczynnik_pory_roku * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Wypełniamy ramkę danych godzinowym zużyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczenie dziennego zużycia energii dla danej pory roku
dzienne_zuzycie <- roczne_zuzycie / dni_w_roku * wspolczynnik_pory_roku
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartości godzinowego zużycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
dni_w_roku <- 365
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Wypełniamy ramkę danych godzinowym zużyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczenie dziennego zużycia energii dla danej pory roku
dzienne_zuzycie <- roczne_zuzycie / dni_w_roku * wspolczynnik_pory_roku
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartości godzinowego zużycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
#https://www.pse.pl/home
# Funkcja określająca porę roku na podstawie daty
pora_roku <- function(data) {
# Pobieranie miesiąca z daty
miesiac <- month(data)
# Określenie pory roku na podstawie miesiąca
if(miesiac %in% c(12, 1, 2)) return("zima")
if(miesiac %in% 3:5) return("wiosna")
if(miesiac %in% 6:8) return("lato")
if(miesiac %in% 9:11) return("jesien")
}
# Współczynniki dla różnych por roku, które odzwierciedlają względne zużycie energii
# Zimą zużycie jest wyższe, latem niższe itp.
wspolczynniki_por_roku <- c(zima = 1.2, wiosna = 1.0, lato = 0.8, jesien = 1.1)
# Funkcja generująca godzinowy rozkład zużycia energii w zależności od pory roku
godzinowy_rozklad_zuzycia <- function(pora) {
# Określanie rozkładu godzinowego w zależności od pory roku
# Dla przykładu w jesieni między godziną 18 a 20 jest największe zużycie
if(pora == "zima") return(c(rep(1.1, 7), rep(1.3, 9), rep(1.5, 3), rep(1.2, 5)))
if(pora == "wiosna") return(c(rep(1, 7), rep(1.2, 10), rep(1.4, 3), rep(1.1, 4)))
if(pora == "lato") return(c(rep(0.9, 8), rep(1, 9), rep(1.3, 3), rep(1, 4)))
if(pora == "jesien") return(c(rep(1, 7), rep(1.2, 8), rep(1.6, 3), rep(1.3, 6)))
}
# Obliczanie sredniego dziennego zużycia energii dla 4-osobowej rodziny
roczne_zuzycie <- 2300
# Tworzymy sekwencje dat na podstawie roku
data_poczatkowa <- as.Date("2018-01-01")
data_koncowa <- as.Date("2022-12-31")
daty <- seq(data_poczatkowa, data_koncowa, by = "days")
# Tworzymy pusta ramke danych z datami i godzinami
godzinowe_dane_zuzycia <- expand.grid(Data = daty, Godzina = sprintf("%02d", c(24, 1:23)))
# Funkcja generująca godzinowe zużycie energii dla danej daty
generuj_godzinowe_zuzycie <- function(data) {
pora <- pora_roku(data)
godzinowy_rozklad <- godzinowy_rozklad_zuzycia(pora)
srednie_dzienne_zuzycie <- roczne_zuzycie / 365 * wspolczynniki_por_roku[pora]
godzinowe_zuzycie <- srednie_dzienne_zuzycie * godzinowy_rozklad / sum(godzinowy_rozklad)
return(godzinowe_zuzycie)
}
# Wypełniamy ramkę danych godzinowym zużyciem energii
godzinowe_dane_zuzycia$Zuzycie <- c()
for (data in unique(godzinowe_dane_zuzycia$Data)) {
# Określenie pory roku dla danej daty
pora <- pora_roku(data)
# Pobieranie współczynnika dla danej pory roku
wspolczynnik_pory_roku <- wspolczynniki_por_roku[pora]
# Obliczenie dziennego zużycia energii dla danej pory roku
dzienne_zuzycie <- roczne_zuzycie / dni_w_roku * wspolczynnik_pory_roku
godzinowe_zuzycie <- generuj_godzinowe_zuzycie(data, dzienne_zuzycie)
# Wybieramy wiersze dla konkretnego dnia i przypisujemy wartości godzinowego zużycia energii
godzinowe_dane_zuzycia$Zuzycie[godzinowe_dane_zuzycia$Data == data] <- godzinowe_zuzycie
}
